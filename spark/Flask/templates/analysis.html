<!DOCTYPE html>
<html>

<head>
    <title>日志分析</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="utf-8">
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/css/styles.css" rel="stylesheet" type="text/css">

    <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>

    <script type="text/javascript" src="../static/js/echarts.js"></script>
    <script type="text/javascript" src="../static/js/china.js"></script>
    <script type="text/javascript" src="../static/js/world.js"></script>
    <script type="text/javascript" src="../static/js/dataTool.js"></script>
    <script type="text/javascript" src="../static/js/bmap.js"></script>
    <script type="text/javascript"
        src="https://api.map.baidu.com/api?v=2.0&amp;ak=KOmVjPVUAey1G2E8zNhPiuQ6QiEmAwZu&amp;__ec_v__=20190126"></script>
    <script type="text/javascript"
        src="https://api.map.baidu.com/getscript?v=2.0&amp;ak=KOmVjPVUAey1G2E8zNhPiuQ6QiEmAwZu&amp;services=&amp;t=20200327103013"></script>

</head>

<body>
    <div class="header">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <!-- Logo -->
                    <div class="logo">
                        <h1><a>实时日志入侵检测系统</a></h1>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="page-content">
        <div class="row">
            <div class="col-md-2">
                <div class="sidebar content-box" style="display: block;">
                    <ul class="nav">
                        <!-- Main menu -->
                        <li><a href="welcome"><i class="glyphicon glyphicon-asterisk"></i> 欢迎</a>
                        </li>
                        <li><a href="about"><i class="glyphicon glyphicon-info-sign"></i> 关于系统</a>
                        </li>
                         <li><a href="outline"><i class="glyphicon glyphicon-cog"></i> 日志管理</a>
                        </li>
                        <li class="current"><a href="analysis"><i class="glyphicon glyphicon-stats"></i> 实时日志分析</a>
                        </li>

                        <li><a href="id"><i class="glyphicon glyphicon-adjust"></i> 实时入侵检测</a>
                        </li>
                        <li><a href="index"><i class="glyphicon glyphicon-cog"></i> 系统设置</a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="col-md-10">
                <div class="row">
                    <div class="col-md-6">
                        <div class="alert alert-success" role="alert">
                            <h4 class="alert-heading">实时日志分析</h4>
                            <p>实时日志分析功能可提供实时日志字段计数、数据图表与地理信息汇总等数据可视化展示功能，数据展示有一定延迟。</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="alert alert-info" role="alert">
                                    <h4 id="sys_time" class="alert-heading">Loading...</h4>
                                    <p>系统时间</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <script>
                        $(document).ready(function () {
                            namespace = '/sys_time';
                            var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
                            socket.on('sys_time', function (res) {
                                document.getElementById("sys_time").innerText = res.data;
                            });
                        });
                    </script>
                </div>

                <div class="row">
                    <div class="col-md-8">
                        <div class="content-box-header">
                            <div class="panel-title">实时计数器</div>
                        </div>
                        <div class="content-box-large box-with-header">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="alert alert-dark" role="alert">
                                        <h4 class="alert-heading">总请求数</h4>
                                        <h2 id="host_count">46097</h2>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="alert alert-dark" role="alert">
                                        <h4 class="alert-heading">成功请求数</h4>
                                        <h2 id="success_count">42652</h2>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="alert alert-dark" role="alert">
                                        <h4 class="alert-heading">其他请求数</h4>
                                        <h2 id="other_count">3445</h2>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="alert alert-dark" role="alert">
                                        <h4 class="alert-heading">访客数</h4>
                                        <h2 id="visitor_count">57</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="alert alert-dark" role="alert">
                                        <h4 class="alert-heading">资源数</h4>
                                        <h2 id="url_count">5319</h2>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="alert alert-dark" role="alert">
                                        <h4 class="alert-heading">流量大小 (MB)</h4>
                                        <h2 id="traffic_sum">475</h2>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="alert alert-dark" role="alert">
                                        <h4 class="alert-heading">日志大小 (MB)</h4>
                                        <h2 id="log_size">573</h2>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <script>
                        $(document).ready(function () {
                            namespace = '/count_board';
                            var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
                            socket.on('count_board', function (res) {
                                document.getElementById("host_count").innerText = res.host_count;
                                document.getElementById("success_count").innerText = res.success_count;
                                document.getElementById("other_count").innerText = res.other_count;
                                document.getElementById("visitor_count").innerText = res.visitor_count;
                                document.getElementById("url_count").innerText = res.url_count;
                                document.getElementById("traffic_sum").innerText = res.traffic_sum;
                                document.getElementById("log_size").innerText = res.log_size;
                            });
                        });
                    </script>


                    <div class="col-md-4">
                        <div class="content-box-header">
                            <div class="panel-title">实时热门位置</div>
                        </div>
                        <div class="content-box-large box-with-header">
                            <div id="geo" style="height:270px;"></div>
                        </div>
                    </div>
                     <script>
                        var geo = echarts.init(document.getElementById('geo'));
                        const data = [
                                        { name: '北京', value: 273 },
                                        { name: '上海', value: 25 },

                                        { name: '合肥', value: 134 },
                                        { name: '武汉', value: 49 },
                                        { name: '大庆', value: 57 },
                                         { name: '泰安', value: 112 },
                                        { name: '诸暨', value: 112 },
                                        { name: '郑州', value: 234 },
                                        { name: '哈尔滨', value: 114 },
                                        { name: '聊城', value: 116 },
                                        { name: '芜湖', value: 117 },
                                        { name: '唐山', value: 119 },
                                        { name: '平顶山', value: 119 },
                                        { name: '邢台', value: 119 },
                                        { name: '德州', value: 120 },
                                        { name: '济宁', value: 120 },
                                        { name: '荆州', value: 127 },
                                        { name: '宜昌', value: 130 },
                                        { name: '义乌', value: 132 },
                                        { name: '丽水', value: 133 },
                                        { name: '洛阳', value: 134 },
                                        { name: '秦皇岛', value: 189 },
                                        { name: '株洲', value: 143 },
                                        { name: '石家庄', value: 147 },
                                        { name: '莱芜', value: 148 },
                                        { name: '常德', value: 152 },
                                        { name: '保定', value: 153 },
                                        { name: '湘潭', value: 154 },
                                        { name: '金华', value: 157 },
                                        { name: '岳阳', value: 169 },
                                        { name: '长沙', value: 175 },
                                        { name: '衢州', value: 177 },
                                        { name: '廊坊', value: 193 },
                                        { name: '菏泽', value: 104 },
];
                                            const geoCoordMap = {
                                                北京: [116.46, 39.92],
                                                上海: [121.48, 31.22],
                                                合肥: [117.27, 31.86],
                                                武汉: [114.31, 30.52],
                                                大庆: [125.03, 46.58],
                                                泰安: [117.13, 36.18],
                                                诸暨: [120.23, 29.71],
                                                郑州: [113.65, 34.76],
                                                哈尔滨: [126.63, 45.75],
                                                聊城: [115.97, 36.45],
                                                芜湖: [118.38, 31.33],
                                                唐山: [118.02, 39.63],
                                                平顶山: [113.29, 33.75],
                                                邢台: [114.48, 37.05],
                                                德州: [116.29, 37.45],
                                                济宁: [116.59, 35.38],
                                                荆州: [112.239741, 30.335165],
                                                宜昌: [111.3, 30.7],
                                                义乌: [120.06, 29.32],
                                                丽水: [119.92, 28.45],
                                                洛阳: [112.44, 34.7],
                                                秦皇岛: [119.57, 39.95],
                                                株洲: [113.16, 27.83],
                                                石家庄: [114.48, 38.03],
                                                莱芜: [117.67, 36.19],
                                                常德: [111.69, 29.05],
                                                保定: [115.48, 38.85],
                                                湘潭: [112.91, 27.87],
                                                金华: [119.64, 29.12],
                                                岳阳: [113.09, 29.37],
                                                长沙: [113, 28.21],
                                                衢州: [118.88, 28.97],
                                                廊坊: [116.7, 39.53],
                                                菏泽: [115.480656, 35.23375]



};
                                            const convertData = function (data) {
  var res = [];
  for (var i = 0; i < data.length; i++) {
    var geoCoord = geoCoordMap[data[i].name];
    if (geoCoord) {
      res.push({
        name: data[i].name,
        value: geoCoord.concat(data[i].value)
      });
    }
  }
  return res;
};
                                                    option = {
  title: {
    text: '热门位置',

    left: 'center'
  },
  tooltip: {
    trigger: 'item'
  },
  bmap: {
    center: [104.114129, 37.550339],
    zoom: 5,
    roam: true,
    mapStyle: {
      styleJson: [
        {
          featureType: 'water',
          elementType: 'all',
          stylers: {
            color: '#d1d1d1'
          }
        },
        {
          featureType: 'land',
          elementType: 'all',
          stylers: {
            color: '#f3f3f3'
          }
        },
        {
          featureType: 'railway',
          elementType: 'all',
          stylers: {
            visibility: 'off'
          }
        },
        {
          featureType: 'highway',
          elementType: 'all',
          stylers: {
            color: '#fdfdfd'
          }
        },
        {
          featureType: 'highway',
          elementType: 'labels',
          stylers: {
            visibility: 'off'
          }
        },
        {
          featureType: 'arterial',
          elementType: 'geometry',
          stylers: {
            color: '#fefefe'
          }
        },
        {
          featureType: 'arterial',
          elementType: 'geometry.fill',
          stylers: {
            color: '#fefefe'
          }
        },
        {
          featureType: 'poi',
          elementType: 'all',
          stylers: {
            visibility: 'off'
          }
        },
        {
          featureType: 'green',
          elementType: 'all',
          stylers: {
            visibility: 'off'
          }
        },
        {
          featureType: 'subway',
          elementType: 'all',
          stylers: {
            visibility: 'off'
          }
        },
        {
          featureType: 'manmade',
          elementType: 'all',
          stylers: {
            color: '#d1d1d1'
          }
        },
        {
          featureType: 'local',
          elementType: 'all',
          stylers: {
            color: '#d1d1d1'
          }
        },
        {
          featureType: 'arterial',
          elementType: 'labels',
          stylers: {
            visibility: 'off'
          }
        },
        {
          featureType: 'boundary',
          elementType: 'all',
          stylers: {
            color: '#fefefe'
          }
        },
        {
          featureType: 'building',
          elementType: 'all',
          stylers: {
            color: '#d1d1d1'
          }
        },
        {
          featureType: 'label',
          elementType: 'labels.text.fill',
          stylers: {
            color: '#888888'
          }
        }
      ]
    }
  },
                                                            series: [
    {
      name: '',
      type: 'scatter',
      coordinateSystem: 'bmap',
      data: convertData(data),
      symbolSize: function (val) {
        return val[2] / 10;
      },
      encode: {
        value: 2
      },
      label: {
        formatter: '{b}',
        position: 'right',
        show: false
      },
      emphasis: {
        label: {
          show: true
        }
      }
    },
    {
      name: 'Top 5',
      type: 'effectScatter',
      coordinateSystem: 'bmap',
      data: convertData(
        data
          .sort(function (a, b) {
            return b.value - a.value;
          })
          .slice(0, 6)
      ),
      symbolSize: function (val) {
        return val[2] / 10;
      },
      encode: {
        value: 2
      },
      showEffectOn: 'render',
      rippleEffect: {
        brushType: 'stroke'
      },
      label: {
        formatter: '{b}',
        position: 'right',
        show: true
      },
      itemStyle: {
        shadowBlur: 10,
        shadowColor: '#666'
      },
      emphasis: {
        scale: true
      },
      zlevel: 1
    }
  ]
}                                       ;
                                                        geo.setOption(option);

                    </script>


                </div>
                <div class="row">
                    <div class="col-md-9">
                        <div class="row">
                            <div class="col-md-7">
                                <div class="content-box-header">
                                    <div class="panel-title">实时热门资源排名</div>
                                </div>
                                <div class="content-box-large box-with-header">

                                    <table id="url" class="table table-sm table-striped">
                                        <thead>
                                            <tr>
                                                <th scope="col">排名</th>
                                                <th scope="col">资源位置</th>
                                                <th scope="col">请求次数</th>
                                            </tr>
                                             <tr>
                                                <td scope="col">1</td>
                                                <td scope="col">/</td>
                                                <td id="t1">0</td>
                                                <script>
                                                    var num = 12795;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t1 = document.getElementById("t1");
                                                    t1.innerText = num+12795;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>

                                            </tr>
                                            <tr>
                                                <td scope="col">2</td>
                                                <td scope="col">*</td>
                                                <td id="t2">0</td>
                                                <script>
                                                    var num = 2652;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t2 = document.getElementById("t2");
                                                    t2.innerText = num+2652;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">3</td>
                                                <td scope="col">/js/jquery.mim.js</td>
                                                <td id="t3">0</td>
                                                <script>
                                                    var num = 766;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t3 = document.getElementById("t3");
                                                    t3.innerText = num+766;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">4</td>
                                                <td scope="col">/css/z1z.css</td>
                                                <td id="t4">0</td>
                                                <script>
                                                    var num = 697;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t4 = document.getElementById("t4");
                                                    t4.innerText = num+697;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">5</td>
                                                <td scope="col">/css/z2z.css</td>
                                                <td id="t5">0</td>
                                                <script>
                                                    var num = 589;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t5 = document.getElementById("t5");
                                                    t5.innerText = num+589;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">6</td>
                                                <td scope="col">/js/wpa.js</td>
                                                <td id="t6">0</td>
                                                <script>
                                                    var num = 432;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t6 = document.getElementById("t6");
                                                    t6.innerText = num+432;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">7</td>
                                                <td scope="col">/css/onee.css</td>
                                                <td id="t7">0</td>
                                                <script>
                                                    var num = 349;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t7 = document.getElementById("t7");
                                                    t7.innerText = num+349;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">8</td>
                                                <td scope="col">/js/obd.js</td>
                                                <td id="t8">0</td>
                                                <script>
                                                    var num = 210;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t8 = document.getElementById("t8");
                                                    t8.innerText = num+210;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">9</td>
                                                <td scope="col">/css/jh.css</td>
                                                <td id="t9">0</td>
                                                <script>
                                                    var num = 187;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t9 = document.getElementById("t9");
                                                    t9.innerText = num+187;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">10</td>
                                                <td scope="col">/css/da.css</td>
                                                <td id="t10">0</td>
                                                <script>
                                                    var num = 156;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("t10");
                                                    t10.innerText = num+156;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>

                                        </thead>
                                        <tbody>

                                        </tbody>
                                    </table>

                                </div>
                            </div>
                            <script>
                                $(document).ready(function () {
                                    namespace = '/hot_url';

                                    var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
                                    var items = ""
                                    socket.on('hot_url', function (res) {
                                        items = ""
                                        $("#url tbody").html("");

                                        $.each(res.data, function (i, item) {
                                            items += "<tr>";
                                            items += "<th scope='row'>" + item.no + "</td>";
                                            items += "<td>" + item.url + "</td>";
                                            items += "<td>" + item.count + "</td>";
                                            items += "</tr>";
                                        });
                                        $('#url tbody').append(items);
                                    });
                                });
                            </script>

                            <div class="col-md-7">
                                <div class="content-box-header">
                                    <div class="panel-title">实时热门IP排名</div>
                                </div>
                                <div class="content-box-large box-with-header">

                                    <table id="ip" class="table table-sm table-striped">
                                        <thead>
                                            <tr>
                                                <th scope="col">排名</th>
                                                <th scope="col">IP地址</th>
                                                <th scope="col">位置</th>
                                                <th scope="col">请求次数</th>
                                            </tr>
                                            <tr>
                                                <td scope="col">1</td>
                                                <td scope="col">202.38.128.53</td>
                                                <td scope="col">北京市</td>
                                                <td id="z1">0</td>
                                                <script>
                                                    var num = 6906;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);
                                                    var t10 = document.getElementById("z1");
                                                    t10.innerText = num+6906;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">2</td>
                                                <td scope="col">192.168.61.179</td>
                                                <td scope="col">上海市</td>
                                                <td id="z2">0</td>
                                                <script>
                                                    var num = 5549;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z2");
                                                    t10.innerText = num+5549;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">3</td>
                                                <td scope="col">192.168.92.130</td>
                                                <td scope="col">郑州市</td>
                                                <td id="z3">0</td>
                                                <script>
                                                    var num = 4378;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z3");
                                                    t10.innerText = num+4378;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">4</td>
                                                <td scope="col">192.168.87.209</td>
                                                <td scope="col">成都市</td>
                                                <td id="z4">0</td>
                                                <script>
                                                    var num = 3745;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z4");
                                                    t10.innerText = num+3745;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">5</td>
                                                <td scope="col">118.169.217.117</td>
                                                <td scope="col">南京市</td>
                                                <td id="z5">0</td>
                                                <script>
                                                    var num = 6906;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z5");
                                                    t10.innerText = num+3324;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">6</td>
                                                <td scope="col">192.168.183.22</td>
                                                <td scope="col">长沙市</td>
                                                <td id="z6">0</td>
                                                <script>
                                                    var num = 2978;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z6");
                                                    t10.innerText = num+2978;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">7</td>
                                                <td scope="col">202.38.128.51</td>
                                                <td scope="col">成都市</td>
                                                <td id="z7">0</td>
                                                <script>
                                                    var num = 2765;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z7");
                                                    t10.innerText = num+2765;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">8</td>
                                                <td scope="col">167.248.133.20</td>
                                                <td scope="col">北京市</td>
                                                <td id="z8">0</td>
                                                <script>
                                                    var num = 2298;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z8");
                                                    t10.innerText = num+2298;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">9</td>
                                                <td scope="col">202.38.128.102</td>
                                                <td scope="col">贵州市</td>
                                                <td id="z9">0</td>
                                                <script>
                                                    var num = 1867;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z9");
                                                    t10.innerText = num+1867;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>
                                            <tr>
                                                <td scope="col">10</td>
                                                <td scope="col">193.27.228.174</td>
                                                <td scope="col">郑州市</td>
                                                <td id="z10">0</td>
                                                <script>
                                                    var num = 946;
                                                    var t = setInterval(function(){
                                                    num+=Math.floor((Math.random() * 10) + 1);;
                                                    var t10 = document.getElementById("z10");
                                                    t10.innerText = num+946;
                                                         if(num==10){
                                                             clearInterval(t);
                                                         }
                                                    },100);

                                                </script>
                                            </tr>

                                        </thead>
                                        <tbody>

                                        </tbody>
                                    </table>

                                </div>
                            </div>
                            <script>
                                $(document).ready(function () {
                                    namespace = '/hot_ip';
                                    var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
                                    var items = ""
                                    socket.on('hot_ip', function (res) {
                                        items = ""
                                        $("#ip tbody").html("");

                                        $.each(res.data, function (i, item) {
                                            items += "<tr>";
                                            items += "<th scope='row'>" + item.no + "</td>";
                                            items += "<td>" + item.ip + "</td>";
                                            items += "<td>" + item.address + "</td>";
                                            items += "<td>" + item.count + "</td>";
                                            items += "</tr>";
                                        });
                                        $('#ip tbody').append(items);
                                    });
                                });
                            </script>
                        </div>





































                        <div class="row">
                            <div class="col-md-6">
                                <div class="content-box-header">
                                    <div class="panel-title">实时状态码比例</div>
                                </div>
                                <div class="content-box-large box-with-header">

                                        <div id="main" style="height: 300px;"></div>

                                </div>
                            </div>


                            <script>
                                var myChart=echarts.init(document.getElementById('main'));
                                var option = {
                                                      title: {
                                                        text: '实时状态码比例',
                                                        left: 'center'
                                                      },
                                                      tooltip: {
                                                        trigger: 'item',
                                                        formatter: '{a} <br/>{b} : {c} ({d}%)'
                                                      },
                                                      legend: {
                                                        orient: 'vertical',
                                                        left: 'left',
                                                        data: []
                                                      },
                                                      series: [
                                                        {
                                                          name: '',
                                                          type: 'pie',
                                                          radius: '55%',
                                                          center: ['50%', '60%'],
                                                          data: [
                                                            { value:1443, name: '200' },
                                                            { value: 232, name: '206' },
                                                            { value: 167, name: '301' },
                                                            { value: 158, name: '302' },
                                                            { value: 489, name: '304' },
                                                            { value: 127, name: '403' },
                                                            { value: 145, name: '404' },
                                                            { value: 167, name: '408' }
                                                                                                          ],
                                                          emphasis: {
                                                            itemStyle: {
                                                              shadowBlur: 10,
                                                              shadowOffsetX: 0,
                                                              shadowColor: 'rgba(0, 0, 0, 0.5)'
                                                            }
                                                          }
                                                        }
                                                      ]
                                                      };
                                myChart.setOption(option);
                                let currentIndex = -1;

                                setInterval(function() {
                                  var dataLen = option.series[0].data.length;
                                  // 取消之前高亮的图形
                                  myChart.dispatchAction({
                                    type: 'downplay',
                                    seriesIndex: 0,
                                    dataIndex: currentIndex
                                  });
                                  currentIndex = (currentIndex + 1) % dataLen;
                                  // 高亮当前图形
                                  myChart.dispatchAction({
                                    type: 'highlight',
                                    seriesIndex: 0,
                                    dataIndex: currentIndex
                                  });
                                  // 显示 tooltip
                                  myChart.dispatchAction({
                                    type: 'showTip',
                                    seriesIndex: 0,
                                    dataIndex: currentIndex
                                  });
                                }, 1000);



                             </script>

                            <div class="col-md-6">
                                <div class="content-box-header">
                                    <div class="panel-title">实时请求方式比例</div>
                                </div>
                                <div class="content-box-large box-with-header">

                                        <div id="mai" style="height: 300px;"></div>

                                </div>
                            </div>


                            <script>
                                var myChart1=echarts.init(document.getElementById('mai'));
                                var option = {
                                                      title: {
                                                        text: '实时请求方式比例',
                                                        left: 'center'
                                                      },
                                                      tooltip: {
                                                        trigger: 'item',
                                                        formatter: '{a} <br/>{b} : {c} ({d}%)'
                                                      },
                                                      legend: {
                                                        orient: 'vertical',
                                                        left: 'left',
                                                        data: []
                                                      },
                                                      series: [
                                                        {
                                                          name: '',
                                                          type: 'pie',
                                                          radius: '55%',
                                                          center: ['50%', '60%'],
                                                          data: [
                                                            { value:1078, name: 'GET' },
                                                            { value: 453, name: 'POST' },
                                                            { value: 376, name: '-' },
                                                            { value: 320, name: 'HEAD' },
                                                            { value: 265, name: 'OPTIONS' }

                                                                                                          ],
                                                          emphasis: {
                                                            itemStyle: {
                                                              shadowBlur: 10,
                                                              shadowOffsetX: 0,
                                                              shadowColor: 'rgba(0, 0, 0, 0.5)'
                                                            }
                                                          }
                                                        }
                                                      ]
                                                      };
                                myChart1.setOption(option);


                                setInterval(function() {
                                  var dataLen = option.series[0].data.length;
                                  // 取消之前高亮的图形
                                  myChart1.dispatchAction({
                                    type: 'downplay',
                                    seriesIndex: 0,
                                    dataIndex: currentIndex
                                  });
                                  currentIndex = (currentIndex + 1) % dataLen;
                                  // 高亮当前图形
                                  myChart1.dispatchAction({
                                    type: 'highlight',
                                    seriesIndex: 0,
                                    dataIndex: currentIndex
                                  });
                                  // 显示 tooltip
                                  myChart.dispatchAction({
                                    type: 'showTip',
                                    seriesIndex: 0,
                                    dataIndex: currentIndex
                                  });
                                }, 1000);



                             </script>


                        </div>

                        <div class="content-box-header">
                            <div class="panel-title">实时请求计数（按时间顺序）</div>
                        </div>
                        <div class="content-box-large box-with-header">
                            <div class="container-fluid">
                                <div id="req_count_timeline" style="height: 350px;"></div>
                            </div>
                        </div>
                       <script>


                                    var myChart2=echarts.init(document.getElementById('req_count_timeline'));
                                    let base3 = +new Date(2020, 5, 3);
let oneDay3 = 24 * 3600 * 1000;
let date3 = [];
let data3 = [Math.random() * 300];
for (let i = 1; i < 5000; i++) {
  var now3 = new Date((base3 += oneDay3));
  date3.push([now3.getFullYear(), now3.getMonth() + 1, now3.getDate()].join('/'));
  data3.push(Math.abs(Math.round((Math.random() -0.5) * 20 + data3[i - 1])));
}
option = {
  tooltip: {
    trigger: 'axis',
    position: function (pt) {
      return [pt[0], '10%'];
    }
  },
  title: {
    left: 'center',
    text: ''
  },
  toolbox: {
    feature: {
      dataZoom: {
        yAxisIndex: 'none'
      },
      restore: {},
      saveAsImage: {}
    }
  },
  xAxis: {
    type: 'category',
    boundaryGap: false,
    data: date3
  },
  yAxis: {
    type: 'value',
    boundaryGap: [0, '100%']
  },
  dataZoom: [
    {
      type: 'inside',
      start: 0,
      end: 10
    },
    {
      start: 0,
      end: 10
    }
  ],
  series: [
    {
      name: 'Fake Data',
      type: 'line',
      symbol: 'none',
      sampling: 'lttb',
      itemStyle: {
        color: 'rgb(255, 70, 131)'
      },
      areaStyle: {
        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
          {
            offset: 0,
            color: 'rgb(255, 158, 68)'
          },
          {
            offset: 1,
            color: 'rgb(255, 70, 131)'
          }
        ])
      },
      data: data3
    }
  ]
};

                                    myChart2.setOption(option);










                         </script>

                        <div class="content-box-header">
                            <div class="panel-title">IP请求数排序</div>
                        </div>
                        <div class="content-box-large box-with-header">
                            <div class="container-fluid">
                                <div id="ip_ranking" style="height: 300px;"></div>
                            </div>
                        </div>
                        <script>

                                    var myChart3=echarts.init(document.getElementById('ip_ranking'));
                                     option = {
  title: {
    text: ''
  },
  tooltip: {
    trigger: 'axis',
    axisPointer: {
      type: 'shadow'
    }
  },
  legend: {},
  grid: {
    left: '3%',
    right: '4%',
    bottom: '3%',
    containLabel: true
  },
  xAxis: {
    type: 'value',
    boundaryGap: [0, 0.01]
  },
  yAxis: {
    type: 'category',
    data: ['192.168.61.179','192.168.92.130',  '192.168.87.209','118.169.217.117','192.168.183.22','202.38.128.53	' ]
  },
  series: [

    {
      name: '',
      type: 'bar',
      data: [
        {
          value: 649,
          itemStyle: {
            color: '#6495ED'
          }
        },
        {
          value: 975,
          itemStyle: {
            color: '#6495ED'
          }
        },
        {
          value: 1297,
          itemStyle: {
            color: '#6495ED'
          }
        },
        {
          value: 1546,
          itemStyle: {
            color: '#6495ED'
          }
        },
        {
          value: 1847,
          itemStyle: {
            color: '#6495ED'
          }
        },
        {
          value: 2347,
          itemStyle: {
            color: '#6495ED'
          }
        },







    ]
    }
  ]
};

                                    myChart3.setOption(option);





                         </script>



                    </div>



                </div>

            </div>
        </div>

        <footer>
            <div class="container">

                <div class="copy text-center">
                    spark分布式实时日志分析与入侵检测系统 <br>
                </div>

            </div>
        </footer>



            // ws数据接口













</html>